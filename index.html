<!doctype html>
<html>
  <head>
    <meta charset="utf-8" http-equiv="content-type" name="viewport" content="width=device-width, initial-scale=1">  
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">

	<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
        <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
  <style>
      body { font: 16px Helvetica, Arial; background-color:#424242;}  
	  
      .auto {border: 2px solid #212121; padding:5px; margin-top:5px; position: relative; height:500px; width:auto; overflow:auto; background-color:#616161}
	  
      * { margin: 0; padding: 0; box-sizing: border-box;}
	  
      .down{ background: #616161; padding: 3px;position: fixed; bottom: 0;width:73%;}
	  
      #messages { list-style-type: none; margin: 0; padding: 0; color: white;}
	  
      #messages li { border-radius: 9px; padding: 5px; background-color: #29B6F6; border: 1px solid #212121;}
	  
      #messages li:nth-child(odd) { background: #eee;  background-color: #29B6F6;} 
	  
	  .logo{ color:#0033ff;}
	  
	  .nickchange{border: 2px solid #212121; float: left; width : 150px; height: 200px; margin-left: 20px; margin-top: 20px; color: red;}
	  
	  .listofusers{border: 2px solid #212121; float : right; width : 150px; height: 200px; margin-right: 20px; margin-top: 20px; color: red;}}
	  
	  .nicktext {background-color: white;}
	  
	  .nickmessage {border: 1px solid #212121;}
	  
	  .messageinput {border: 0; padding: 10px; margin-right: .5%; background-color : #0277BD;}
	  
	  .nickchangeinput {border-radius: 5px; width: 140px; margin-left: 3px; color: black;}
	  
	  .nickchangebutton {width : 100px; margin-left : 15px;}
	  
	  </style>
  </head>
  
  <body>
		<div class = "col-ms-4 nickchange">
			<p align = "center" > Wpisz swój nick </p>
				<form action>
					<input type="text" name="nickchange" id = "nick" class = "nickchangeinput" />
				</form>
			<button class= "btn btn-success nickchangebutton"> Zmien </button>
		</div>
		<!--<div class = "col-ms-4 listofusers">
			<p align = "center" > Lista użytkowników </p>
			<ul id="users" >
			</ul>
		</div>-->
    <div class = "container">
				<div class="col-ms4 logo">
					<img src = "http://localhost:5000/img/bluebird.png" alt="BLUEBIRD CHAT" height="50px"/>
				</div>
			<div class="row auto messages-scroll">
			<ul id="messages" >
			</ul>
        </div>
        <div class="row down">
                <form action ="">       			
					<input class = "col-md-11 messageinput" id="m" autocomplete="off" /> 
					<button class = "btn btn-lg btn-primary">Send</button>
                 </form>    
		</div>    
        <script>
          var socket = io({
				transports: [
					'polling', 
					],
				'polling duration' : 10
			});
		    var id = "user" + guid();
			function guid() {
				function s4() {
					return Math.floor((Math.random()) * 0x10000)
				}
				return s4() + s4();
			}
          $('form').submit(function(){
          socket.emit('chat message', {id: id, message: $('#m').val()});
          $('#m').val('');
          return false;
          });
		  $('.nickchangebutton').on('click', function(){
		  id = $('#nick').val();
		  });
          socket.on('chat message', function(msg){
          $('#messages').append($('<li>').html('<b>'+msg.id + "</b> " + msg.message))
		  $(".auto").scrollTop($(".messages-scroll")[0].scrollHeight)
          });
			</script>
        </script>
    </div>
  </body>
</html>
